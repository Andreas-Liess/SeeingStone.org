# Codebase Structure

**Analysis Date:** 2026-01-25

## Directory Layout

```
SeeingStone.org new experimental/
├── .planning/
│   └── codebase/                       # Planning documents
├── api/
│   └── signup.js                       # Vercel serverless form handler
├── assets/
│   └── logo/                           # Logo files
├── components/
│   ├── demo-box-1/                     # Agent reasoning flow demo
│   │   ├── index.html
│   │   ├── script.js
│   │   └── style.css
│   ├── demo-box-2/                     # Network graph demo (Cytoscape)
│   │   ├── index.html
│   │   ├── script.js
│   │   └── style.css
│   ├── demo-box-3/                     # Thread/communications demo
│   │   ├── index.html
│   │   ├── style.css
│   │   └── (no script - CSS only)
│   ├── demo-box-4/                     # Protocol manager demo
│   │   ├── index.html
│   │   ├── script.js
│   │   └── style.css
│   └── terminal.css                    # Shared terminal styling
├── css/                                # Legacy CSS (deprecated, use css-new/)
│   ├── common.css
│   ├── home.css
│   └── theorb.css
├── css-new/                            # Active design system
│   ├── main.css                        # Orchestrator (imports all modules)
│   ├── global.css                      # Variables, reset, base elements
│   ├── layout.css                      # Grid, containers, sections
│   ├── components.css                  # Buttons, cards, forms, nav, etc.
│   └── test-design-system.html         # Design token reference page
├── js/
│   ├── analytics/
│   │   ├── analytics.js                # Orchestrator (imports trackers)
│   │   ├── analyzer.js                 # Intent derivation logic
│   │   ├── formatter.js                # Data formatting helpers
│   │   └── trackers/
│   │       ├── timeTracker.js          # Session and typing duration
│   │       ├── navigationTracker.js    # Page history, entry/exit
│   │       ├── engagementTracker.js    # Scroll depth, interactions
│   │       └── contextTracker.js       # Device, timezone, language
│   ├── navigation.js                   # Mobile menu, active links
│   └── theorb.js                       # Visual animation (legacy)
├── pages/
│   ├── features/
│   │   ├── index.html
│   │   ├── css/features.css
│   │   └── js/features.js              # Tab switching logic
│   ├── security/
│   │   ├── index.html
│   │   ├── css/security.css
│   │   └── js/security.js              # Likely empty or minimal
│   └── signup/
│       ├── index.html
│       ├── css/signup.css
│       └── js/signup.js                # Form submission handler
├── index.html                          # Home page
├── GEMENI.md                           # Gemini API documentation (legacy)
├── style_sheet.md                      # Stylesheet reference (legacy)
└── .git/                               # Git repository
```

## Directory Purposes

**`.planning/codebase/`:**
- Purpose: GSD codebase analysis documents
- Contains: ARCHITECTURE.md, STRUCTURE.md, CONVENTIONS.md, etc.
- Generated by planning system

**`api/`:**
- Purpose: Backend handlers (Vercel serverless functions)
- Contains: Form submission endpoint
- Key files: `signup.js` - Handles form submissions to Google Forms

**`assets/logo/`:**
- Purpose: Brand assets
- Contains: Logo files (likely SVG or raster)

**`components/`:**
- Purpose: Reusable interactive demo components
- Contains: Self-contained HTML/CSS/JS modules
- Key files:
  - `demo-box-1/` - Shows agent reasoning with streaming log display
  - `demo-box-2/` - Network graph visualization via Cytoscape
  - `demo-box-3/` - Thread extraction interface
  - `demo-box-4/` - Connection/protocol manager

**`css/` (Legacy):**
- Purpose: Original stylesheet (superseded by css-new/)
- Status: Deprecated - use `css-new/` for new work

**`css-new/` (Active):**
- Purpose: Centralized design system
- Contains: Design tokens, layout utilities, component styles
- Key files:
  - `global.css` - CSS variables (colors, spacing, fonts), reset
  - `layout.css` - Container system, grid layout
  - `components.css` - Button, card, form, nav, badge styles
  - `main.css` - Import orchestrator

**`js/analytics/`:**
- Purpose: User behavior tracking and intent analysis
- Contains: Tracker modules, orchestrator, analysis logic
- Key files:
  - `analytics.js` - Loads all trackers, manages form submission interception
  - Trackers: Time (duration/typing), Navigation (history), Engagement (scroll), Context (device)

**`js/`:**
- Purpose: Shared JavaScript utilities
- Key files:
  - `navigation.js` - Mobile menu toggle, active link highlighting
  - `theorb.js` - Visual animation (legacy)

**`pages/features/`:**
- Purpose: System capabilities demonstration page
- Contains: Tab-based interface with 4 embedded demos
- Key files: `features.js` - Tab switching logic

**`pages/security/`:**
- Purpose: Security/compliance information page
- Contains: Deployment tier cards, security mandates
- Key files: `index.html` - Static content, minimal JS

**`pages/signup/`:**
- Purpose: Access request form
- Contains: Form inputs, submission logic, analytics tracking
- Key files: `signup.js` - Form handler + analytics integration

## Key File Locations

**Entry Points:**
- `index.html` - Home/landing page (root)
- `pages/features/index.html` - Features/capabilities showcase
- `pages/security/index.html` - Security information
- `pages/signup/index.html` - Access request form

**Configuration:**
- `.planning/codebase/` - Planning documents
- `css-new/global.css` - Design tokens/variables

**Core Logic:**
- `js/analytics/analytics.js` - Behavior tracking orchestrator
- `api/signup.js` - Form submission backend
- `pages/features/js/features.js` - Tab switching logic
- `pages/signup/js/signup.js` - Form submission frontend

**Testing:**
- No test files detected (no Jest, Vitest, or test runners configured)

## Naming Conventions

**Files:**
- Pages: `index.html` at each level (root, `pages/*/`, `components/*/`)
- Scripts: camelCase (e.g., `navigation.js`, `analytics.js`, `timeTracker.js`)
- Styles: camelCase (e.g., `global.css`, `layout.css`, `components.css`)
- Components: `demo-box-[number]` for demo containers

**Directories:**
- Feature groups: lowercase descriptive names (e.g., `analytics`, `trackers`, `components`)
- Page sections: lowercase with hyphens for multi-word (e.g., `demo-box-1`)
- CSS: `css-new/` for active system (vs deprecated `css/`)

**Functions:**
- camelCase (e.g., `toggleManifesto()`, `switchTab()`, `handleSubmit()`)
- Prefixed with action verb (e.g., `init()`, `getData()`, `add*()`)

**Variables:**
- camelCase for JS variables
- UPPER_SNAKE_CASE for constants (e.g., `FORM_ID`, `GOOGLE_URL`)
- CSS variables: --kebab-case with category prefix (e.g., `--color-orange`, `--space-4`, `--font-mono`)

**Types/Classes:**
- PascalCase (e.g., `AnalyticsOrchestrator`, `TimeTracker`, `ContextTracker`)

## Where to Add New Code

**New Feature:**
- Primary code: Create new page in `pages/[feature-name]/index.html`
- Styles: `pages/[feature-name]/css/[feature-name].css`
- JavaScript: `pages/[feature-name]/js/[feature-name].js`
- Register in navigation: Add link to `.nav-menu` in header

**New Component/Demo:**
- Implementation: `components/demo-box-[N]/` with index.html, script.js, style.css
- Embed: Reference via `<iframe src="components/demo-box-[N]/index.html">`
- Register tab: Add `<button class="tab-btn">` in features page tabs section

**Utilities/Helpers:**
- Shared helpers: `js/` directory (e.g., `js/helpers.js`)
- Tracker modules: `js/analytics/trackers/[name].js`

**Styles:**
- Global tokens: Modify `css-new/global.css` `:root` variables
- Layout utilities: Add to `css-new/layout.css`
- Component patterns: Add to `css-new/components.css`
- Page-specific overrides: `pages/[page-name]/css/[page-name].css`

**API Endpoints:**
- Backend handlers: Create new file in `api/[endpoint-name].js`
- Format: Export default async function with `(req, res)` signature (Vercel convention)

## Special Directories

**`css-new/`:**
- Purpose: Active design system (replaces legacy `css/`)
- Generated: No (hand-written)
- Committed: Yes

**`api/`:**
- Purpose: Vercel serverless functions
- Generated: No (hand-written)
- Committed: Yes
- Note: Functions deployed automatically when pushed to Vercel

**`components/`:**
- Purpose: Demo component modules
- Generated: Partially (demo content is hand-authored, visualizations may be generated client-side)
- Committed: Yes

**`.planning/codebase/`:**
- Purpose: GSD analysis documents
- Generated: Yes (by analysis agent)
- Committed: Yes

**`js/analytics/trackers/`:**
- Purpose: Modular analytics collectors
- Generated: No (hand-written)
- Committed: Yes

## Import Patterns

**CSS System (Cascading):**
```html
<!-- In HTML pages -->
<link rel="stylesheet" href="css-new/main.css">
```
Main.css imports in order: global.css → layout.css → components.css

**JavaScript Modules:**
```javascript
// In analytics.js (ES6 modules)
import { TimeTracker } from './trackers/timeTracker.js';
import { NavigationTracker } from './trackers/navigationTracker.js';
```

**Script Loading (Non-module):**
```html
<!-- In HTML, order matters -->
<script src="js/navigation.js"></script>           <!-- Utilities first -->
<script type="module" src="js/analytics/analytics.js"></script>  <!-- Modules -->
<script src="pages/signup/js/signup.js"></script>  <!-- Page-specific last -->
```

**IFrame Embedding (Isolated):**
```html
<iframe src="components/demo-box-1/index.html" class="demo-frame"></iframe>
```
Each component loads its own CSS/JS - completely isolated from parent page

## Dependency Graph

```
index.html
├── css-new/main.css (global.css + layout.css + components.css)
├── js/navigation.js
└── components/demo-box-1/index.html (isolated)

pages/features/index.html
├── css-new/main.css
├── js/navigation.js
├── pages/features/js/features.js
└── components/demo-box-[1-4]/index.html (via iframe, isolated)

pages/signup/index.html
├── css-new/main.css
├── js/navigation.js
├── js/analytics/analytics.js (orchestrates trackers)
│   ├── trackers/timeTracker.js
│   ├── trackers/navigationTracker.js
│   ├── trackers/engagementTracker.js
│   └── trackers/contextTracker.js
├── pages/signup/js/signup.js
└── api/signup.js (via fetch POST)

api/signup.js
└── Google Forms endpoint (external)
```
